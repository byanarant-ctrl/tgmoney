<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Budget Mini App</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
  </head>
  <body>
    <div class="bg"></div>
    <main class="app">
      <header class="top">
        <div class="title">Общий бюджет</div>
        <strong id="balance">0.00</strong>
        <div class="subtitle">Разница между доходами и расходами</div>
      </header>

      <section class="main-actions">
        <button class="pill income" data-target="income">
          + Доходы
        </button>
        <button class="pill expense" data-target="expense">
          - Расходы
        </button>
        <button class="pill plans" data-target="plans">
          Планы
        </button>
        <button class="pill stats" data-target="stats">
          Статистика
        </button>
      </section>


      <section class="panel hidden" id="panel-income">
        <h2>Доходы</h2>
        <div class="form">
          <input id="income-amount" type="number" min="0" step="0.01" placeholder="Сумма" />
          <input id="income-desc" type="text" maxlength="120" placeholder="Описание" />
          <input id="income-category" type="text" maxlength="40" placeholder="Категория" />
          <button id="income-add">Добавить доход</button>
        </div>
        <div class="result" id="income-result"></div>
        <div class="list" id="income-list"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-expense">
        <h2>Расходы</h2>
        <div class="form">
          <input id="expense-amount" type="number" min="0" step="0.01" placeholder="Сумма" />
          <input id="expense-desc" type="text" maxlength="120" placeholder="Описание" />
          <input id="expense-category" type="text" maxlength="40" placeholder="Категория" />
          <button id="expense-add">Добавить расход</button>
        </div>
        <div class="result" id="expense-result"></div>
        <div class="list" id="expense-list"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-plans">
        <h2>Планы</h2>
        <button id="plan-add-open">Добавить план</button>
        <div id="plans-list" class="plans-list"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-plan-create">
        <h2>Новый план</h2>
        <div class="form">
          <input id="plan-title" type="text" maxlength="80" placeholder="Название" />
          <input id="plan-desc" type="text" maxlength="140" placeholder="Описание" />
          <input id="plan-amount" type="number" min="0" step="0.01" placeholder="Сумма" />
          <button id="plan-save">Сохранить</button>
        </div>
        <div class="result" id="plan-result"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-plan-detail">
        <h2>План</h2>
        <div class="result" id="plan-current"></div>
        <div class="form">
          <input id="plan-edit-title" type="text" maxlength="80" placeholder="Название" />
          <input id="plan-edit-desc" type="text" maxlength="140" placeholder="Описание" />
          <input id="plan-edit-target" type="number" min="0" step="0.01" placeholder="Сумма цели" />
          <button id="plan-edit-save">Сохранить изменения</button>
        </div>
        <div class="form">
          <input id="plan-deposit-amount" type="number" min="0" step="0.01" placeholder="Пополнить" />
          <button id="plan-deposit">Пополнить план</button>
        </div>
        <div class="result" id="plan-edit-result"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-stats">
        <h2>Статистика</h2>
        <div class="quick">
          <button id="stats-income">Доходы</button>
          <button id="stats-expense">Расходы</button>
        </div>
        <div class="quick">
          <button data-period="week">Неделя</button>
          <button data-period="month">Месяц</button>
          <button data-period="year">Год</button>
        </div>
        <div class="chart-controls">
          <input id="stats-start" type="date" />
          <input id="stats-end" type="date" />
          <button id="stats-apply">Показать</button>
        </div>
        <div class="result" id="stats-result"></div>
        <canvas id="stats-chart-canvas" height="240"></canvas>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-transaction-edit">
        <h2>Изменить запись</h2>
        <div class="form">
          <input id="tx-edit-amount" type="number" min="0" step="0.01" placeholder="Сумма" />
          <input id="tx-edit-desc" type="text" maxlength="120" placeholder="Описание" />
          <input id="tx-edit-category" type="text" maxlength="40" placeholder="Категория" />
          <button id="tx-edit-save">Сохранить</button>
        </div>
        <div class="result" id="tx-edit-result"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-settings">
        <h2>Настройки</h2>
        <div class="form">
          <button id="invite-create">Создать код приглашения</button>
          <div class="result" id="invite-code"></div>
        </div>
        <div class="form">
          <input id="join-code" type="text" maxlength="16" placeholder="Код приглашения" />
          <button id="join-submit">Присоединиться</button>
        </div>
        <div class="form">
          <button id="switch-budget">Переключить бюджет</button>
        </div>
        <div class="form">
          <button id="leave-budget">Выйти из общего бюджета</button>
        </div>
        <div class="form">
          <div class="result">Пользователи общего бюджета:</div>
          <div id="users-list" class="list"></div>
        </div>
        <div class="result" id="settings-result"></div>
        <button class="back">Назад</button>
      </section>

      <section class="panel hidden" id="panel-error">
        <h2>Ошибка</h2>
        <p id="error-message"></p>
      </section>
    </main>
    <button class="fab gear" id="settings-open" aria-label="Настройки">⚙</button>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
  </body>
</html>
